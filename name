#include <iostream>
#include <string>
#include <fstream>

struct MapInfo {
	int row = 0;
	int col = 0;
	std::string map;
};

void zad1(std::string fileName, MapInfo &mapinfo);
int zad2(MapInfo& mapinfo, int r, int c);
std::pair<int, int> best(MapInfo &mapinfo);

int main()
{
	MapInfo mapinfo;

	zad1("C:\\Users\\G\\source\\repos\\testy_kolos\\testy_kolos\\map_10.txt", mapinfo);

	std::cout << mapinfo.col << "\t" << mapinfo.row << "\t" << zad2(mapinfo,20,22) << "\t(" << best(mapinfo).first << "," << best(mapinfo).second << ")\n\n" << mapinfo.map << "\n\n";

	return 0;
}

void zad1(std::string fileName, MapInfo &mapinfo) {
	std::ifstream readFile(fileName);
	std::string line;

	while (std::getline(readFile, line)) {
		if (mapinfo.row == 0) {
			mapinfo.col = line.length();
		}
		mapinfo.map += line + "\n";
		mapinfo.row++;
	}
	readFile.close();
}

int zad2(MapInfo &mapinfo, int r, int c) {
	int treasureCount = 0;
	for (int y = r - 2; y <= r + 2; y++) {
		for (int x = c - 2; x <= c + 2; x++) {
			if (x >= 0 && y >= 0 && x < mapinfo.col && y < mapinfo.row) {
				int index = y * (mapinfo.col + 1) + x;
				if (mapinfo.map[index] == 'x' || mapinfo.map[index] == 'X') treasureCount++;
			}
		}
	}
	return treasureCount;
}

std::pair<int, int> best(MapInfo &mapinfo) {
	std::pair<int, int> best = {0,0};
	int bestCount = 0;

	for (int y = 0; y < mapinfo.row; y++) {
		for (int x = 0; x < mapinfo.col; x++) {
			int currentCount = zad2(mapinfo, y, x);
			if (currentCount >= bestCount) {
				bestCount = currentCount;
				best.first = x;
				best.second = y;
			}
		}
	}
	return best;
}
